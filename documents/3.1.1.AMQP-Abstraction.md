# AMQP 추상화

## 소개

Spring AMQP 는 JAR 로 만들어진 유용하 모듈들로 구성된다. 모듈은 spring-amqp, spring-rabbit 이다.

spring-amqp 모듈은 **org.springframework.amqp.core** 패키지를 포함한다. 이 패키지에서 AMQP 코어 모델의 클래스들을 발견하 수 있다.

우리의 목적은 클라이언트 라이브러리나 어떤 특별한 AMQP 구현체에 의존하지 않고 일반적인 추상화를 제공하는 것이다.

최종 사용자 코드는 추상 계층에서만 구현되기 때문에 여러 구현 회사들의 이식성에 뛰어납니다.

추상화는 spring-rabbit 처럼 특정 모듈에 의해 구현되어 집니다.

현재 RabbitMQ 구현체만 하나만 있지만 추상화는 rabbit mq 뿐만 아니라 Apache Qpid 를 사용하는 .NET 에게도 검증되었습니다.

AMQP 는 원칙적으로 프로토콜 레벨에서 다뤄지는데 동일한 프로토콜을 지원하느 어떤 브로커든 함께 사용할 수 있습니다. 그러나 그러한 브로커를 테스트하지
않았습니다.

여기서는 기본적인 AMQP 명세와 친숙해졌다고 가정합니다. 그렇지 않다면 [CH.5](https://docs.spring.io/spring-amqp/docs/1.6.11.RELEASE/reference/html/resources.html)에 자원 목록을 한번 보고 오세요

## Message

AMQP 명세에서는 Message 클래스나 인터페이스를 정의하지 않습니다. 대신 **basicPublish()** 와 같은 연산을 수행할 때 내용은 byte-array 매개 변수로
전달 되어지고 추가적인 속성은 분할된 매개변수로 전달됩니다.

Spring AMQP 는 더 나은 일반적인 AMQP 도메인 모델 표현으로 Message 클래스를 정의합니다.

Message 클래스의 목적은 API 를 간결하게 하기 위해 body 와 properties 를 하나의 인스턴스에서 간단하게 캡슐화하는 것입니다.

메시지 클래스 정의는 다음을 보세요

```java
public class Message {
  private final MessageProperties messageProperties;
  prviate final byte[] body;
  
  public Message(byte[] body, MessageProperties messageProperties) {
    this.body = body;
    this.messageProperties = messageProperties;
  }
  
  public byte[] getBody() {
    return this.body;
  }
  
  public MessageProperties getMessageProperties() {
    return this.messageProperties;
  }
}
```
